---
title: "Visualizations"
author: "Marian Dumitrascu"
date: "March 26, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
# install.packages("ISLR")
# install.packages("orientlib")
# install.packages("RSpincalc")
# devtools::install_github("collectivemedia/tictoc")
# install.packages("kableExtra")
# install.packages("plot3D")
# install.packages("plotly")
library(readr)
library(tidyverse)
library(ISLR)
library(caret)
library(orientlib)
library(matrixStats)
library(randomForest)
library(RSpincalc)
library(tictoc)
library(kableExtra)

library(plotly)
```





## Visualization of Training Data


```{r, fig.width=16, fig.height=9, fig.retina=4}

x_train_matrix <- x_train_processed %>% select(-surface, -series_id) %>% as.matrix()
x_test_matrix <- x_test_processed %>% select(-series_id) %>% as.matrix()

names_to_removed_train <- findCorrelation(cor(x_train_matrix), cutoff = 0.9, names = TRUE, verbose = FALSE, exact=TRUE)
names_to_remove_test <- findCorrelation(cor(x_test_matrix), cutoff = 0.9, names = TRUE, verbose = FALSE, exact=TRUE)

# remove correlated features from both train and test sets
x_train_processed <- x_train_processed %>% select(-names_to_remove_test) 
x_test_processed <- x_test_processed %>% select(-names_to_remove_test) 

rm(x_train_matrix, x_test_matrix, names_to_removed_train, names_to_remove_test)


x_train_matrix <- x_train_processed %>% select(-surface, -series_id) %>% as.matrix()
findLinearCombos(x_train_matrix)

xx <- x_train_processed %>% select(-surface, -series_id)
names(xx)[19]
names(xx)[20]
names(xx)[21]
names(xx)[25]
names(xx)[30]

# check to see if there is any correlation in the initial data
x_test_matrix <- x_test %>% select(-series_id, -row_id, -measurement_number) %>% as.matrix()
findCorrelation(cor(x_test_matrix), cutoff = 0.9, names = TRUE, verbose = FALSE, exact=TRUE)




#####
# totals vs mean_to_sd

x_train_processed %>%  ggplot(aes(dist_total, dist_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(omega_total, omega_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total*omega_total,dist_mean_to_sd*omega_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(euler_total, euler_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)
# euler_total is not relevant
```


```{r, fig.width=13, fig.height=10, fig.retina=4}
x_train_processed %>% scatter3D(x_train_processed$f1, x_train_processed$f2, x_train_processed$f3, colvar = as.numeric(x_train_processed$surface)/10, col = NULL, add = FALSE)

plot_ly(x=x_train_processed$f1, y=x_train_processed$f2, z=x_train_processed$f3, type="scatter3d", mode="markers", color=x_train_processed$surface)

# #####################################################################################################
# euler gyro angles
x_train_processed %>%  ggplot(aes(phi_mean_all, psi_mean_all, fill = surface)) +
	geom_point(aes(color = surface)) + 
	geom_point(cex=6, pch=21)

# this is a circle
x_train_processed %>%  ggplot(aes(theta_mean_all, psi_mean_all, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

# this is a wave
x_train_processed %>%  ggplot(aes(theta_mean_all, phi_mean_all, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(abs(atan(dist_mean_to_sd/omega_mean_to_sd)), atan(theta_mean_all/psi_mean_all), fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=5, pch=21)

x_pool_sub %>%  ggplot(aes(atan(dist_mean_to_sd/omega_mean_to_sd), atan(theta_mean_all/psi_mean_all), fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=5, pch=21)


x_train_processed %>%  ggplot(aes(log(dist_total*omega_total), abs(atan(theta_mean_all/psi_mean_all)), fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=5, pch=21)

x_train_processed %>%  ggplot(aes(log(dist_mean_to_sd*omega_mean_to_sd), abs(atan(theta_mean_all/psi_mean_all)), fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=5, pch=21)

# #####################################################################################################
```



```{r, fig.width=13, fig.height=10, fig.retina=4}

x_train_processed %>%  ggplot(aes(phi_mean_to_sd_all, psi_mean_to_sd_all, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(phi_mean_to_sd_all, theta_mean_to_sd_all, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(theta_mean_to_sd_all, psi_mean_to_sd_all, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(psi_mean_to_sd, phi_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(theta_mean_to_sd, phi_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(theta_mean_to_sd, psi_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)



x_train_processed %>%  ggplot(aes(dist_total, omega_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, phi_total + theta_total + psi_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)
```


```{r, fig.width=16, fig.height=9, fig.retina=4}

#####
# dist_mean_to_sd vs omega_mean_to_sd vs euler_mean_to_sd

x_train_processed %>%  ggplot(aes(euler_mean_to_sd, dist_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(euler_mean_to_sd, omega_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_mean_to_sd, omega_mean_to_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

```


```{r, fig.width=16, fig.height=9, fig.retina=4}


#####
# dist_total vs omega_total vs euler_total, radius of dist to omega vs dist to omega angle
x_train_processed %>%  ggplot(aes(dist_total, theta_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, psi_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, omega_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, euler_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(sqrt(dist_total^2 + omega_total^2), omega_total/dist_total, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(sqrt(dist_total^2 + euler_total^2), euler_total/dist_total, fill = surface)) +
	geom_point(aes(color = surface))+
	geom_point(cex=6, pch=21)

```


```{r, fig.width=16, fig.height=9, fig.retina=4}
#####
# dist to sd of phi, theta psi
x_train_processed %>%  ggplot(aes(dist_total, phi_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, theta_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

x_train_processed %>%  ggplot(aes(dist_total, psi_sd, fill = surface)) +
	geom_point(aes(color = surface)) +
	geom_point(cex=6, pch=21)

tmp <- x_train_processed %>% group_by(surface) %>% 
	summarize( omega_sd_of_mean_to_sd = sd(omega_mean_to_sd),
						 dist_sd_of_mean_to_sd = sd(dist_mean_to_sd)
					)

# x_train_processed %>% filter(surface == "soft_tiles")
```

## Visualization of Test Data

```{r, fig.width=16, fig.height=9, fig.retina=4}
x_test_processed %>%  ggplot(aes(dist_total, theta_total, fill = surface)) +
	geom_point(aes(color = surface))

x_test_processed %>%  ggplot(aes(dist_total, psi_total, fill = surface)) +
	geom_point(aes(color = surface))

x_test_processed %>%  ggplot(aes(dist_total, euler_total, fill = surface)) +
	geom_point(aes(color = surface))

x_test_processed %>%  ggplot(aes(sqrt(dist_total^2 + omega_total^2), omega_total/dist_total, fill = surface)) +
	geom_point(aes(color = surface))

```

